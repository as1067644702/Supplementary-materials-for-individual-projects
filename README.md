## Supplementary-materials-for-individual-projects
Supplementary materials for individual projects（Xiuzhiping Quan）
#Materials and Methods
Data preprocessing for basic population structure research
Sites with > 20% missing data and minor allele frequency < 0.05 were removed from the dataset provided to me using both VCFtools (version 0.1.16) and PLINK (version 1.90b6.21)(Danecek et al., 2011; Chang et al., 2015). Use PLINK to create plink files from the files obtained in the previous step and perform linkage pruning. This step uses the "--indep-pairwise" command to set the window size to 100kb, set the step size to 50, and set the threshold to 0.1 to generate a pruned subset of markers that are in approximate linkage equilibrium (supplementary script S1, Supplementary Material online).

Population ancestry prediction and visualization
From multilocus SNP genotype datasets, ADMIXTURE is a technique for maximum likelihood estimate of individual ancestries. I used ADMIXTURE (version 1.3.0) to perform population ancestry predictions on the files generated in the previous step (Alexander, Novembre and Lange, 2009). At the same time, the cross-validation error under different K values was calculated to view the optimal number of ancestors predicted by this method, and a line graph of the calculation result was drawn on Rstudio (table S1, Supplementary Material online; fig. 2B). Finally, the results of the predicted ancestry were visualized using two methods. The first was visualized directly using TBtools software (Chen et al., 2020). Another used the pong package (version 1.5) for visualization on HPC (Behr et al., 2016). The visualized graphics of the two are similar, and the latter with better visualization effect is finally selected as the view of ancestor prediction (supplementary script S2; fig. S1, Supplementary Material online). 

Principal component analysis (PCA)
In this step, I also used the two methods of PLINK and gtca (version 1.94.1) for PCA (Yang et al., 2011). The explanatory degrees under the first 20 dimensions calculated by the two methods are the same(table S2, Supplementary Material online; fig. 3B). Finally I visualized the PCA results using PLINK in Rstudio in the context of PC1 and PC2 dimensions(supplementary script S3, Supplementary Material online; fig. 3A).

Constructing phylogenetic trees
Firstly I used Tassel 5 software to convert the .ped and .map files previously generated with PLINK into .phy format to facilitate the next step of phylogenetic tree generation (Bradbury et al., 2007). Next, I used the IQ-TREE package (version 2.2.2.3) to generate a phylogenetic tree file, and finally visualised the tree file on the iTOL website and beautified it (Nguyen et al., 2014; Letunic and Bork, 2021)(supplementary script S4, Supplementary Material online; fig. 3C). By efficiently carrying out locally optimal sampling in the tree space, IQ-TREE constructs maximum likelihood (ML) trees quickly.

Genome selection scanning
The "selective sweep" and related concepts of Fst values were proposed as early as the 20th century (Wright, 1931; Lewontin and Krakauer, 1973; Smith and Haigh, 1974). I chose to use VCFtools to perform a genome scan of the dataset. The way VCFtools calculates Fst (fixation index) values is based on the Weir and Cockerham (1984) study:

p is the expected frequency of the allele (i.e., its frequency in the ancestral population),  represents the mean of the expected frequency, and  represents the variance. The Fst values for each window were calculated with the window size set to 5000kb and the window step set to 2500kb. The results of the calculations were arranged in descending order of weighted Fst values, and the top 1% of windows were selected as candidates for possible corresponding selection signals. The scanned files were used to create overall Manhattan (Fst) plots for each of the three populations, NEN, JOR and ODN, and a red line was drawn to separate the candidate window from the non-candidate window using the Fst value of the last candidate in the candidate windows for each population as a reference (supplementary script S5, Supplementary Material online; fig. 4).

Gene Ontology (GO) enrichment analysis
I generated a new file using the list of candidate windows identified in the previous step. The file was then further filtered by the number of SNPs greater than 10 and organised to contain only three columns, chromosome number (CHR), window start position (START) and window end position (END). The next step is to convert the collated file into a tab-delimited file whose format is a tab-delimited file with a zero index (the first position in the chromosome is zero), i.e., the file contains the chromosome, the window start site - 1, and the window end site. And then this file was sequentially arranged in order of chromosome number and gene number, respectively, along with the original genome file (containing the number, start position, and end position of each gene) that was provided to me. Next I used BEDtools (version 2.31.0) to pair the two files and filter out the lines where the absolute value of the distance between the gene and the window is less than 1000kb (Quinlan and Hall, 2010). This was once done to leave behind genes that might be associated with abnormal Fst windows. All the above operations were performed again for all the windows obtained from the genome scan. GO enrichment analysis was performed in RStudio using the topGO package using the two final files obtained above as well as the GO terminology files provided to me (Alexa and Rahnenfuhrer, 2023)(supplementary script S6; table S3, Supplementary Material online).

Identify possible candidate genes
I used to use RStudio to draw local Fst plots for each gene that overlapped with the anomaly window. Each Fst plot starts 25000kb before the gene start site and ends 25000kb after the gene stop site. Shaded areas are used to represent the region where the gene is located, and arrows are used to point in the direction of the gene. Read values from the Fst values for individual SNPs file printed using VCFtools are plotted in Fst plots as scatter points(supplementary script S7, Supplementary Material online).
The next step is to use another script in RStudio to look at the names of the genes with the highest homology corresponding to the genes contained in each Fst plot, especially the gene numbers that have a scatter of higher Fst values within the gene region. Homologous gene names were obtained from the BLAST file provided to me for Cochlearia vs. Arabidopsis. The names of the genes most likely to be homologous to the anomalous genes were determined based on the e-value as well as the hit score within the file(supplementary script S8, Supplementary Material online).
Finally, gene-related information was queried on the UniProt and NCBI websites, and possible candidate genes responsive to heavy metal stress selection signals were identified by reviewing the literature(supplementary .rarfile S1, Supplementary Material online).
